<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laporan K3RS/MFK</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://fpcdn.io/v3/1L3Y8V8X5W9A2C3E6F7G8H9J0K1L2M3N4O5P6Q7R8S9T0U1V2W3X4Y5Z6.js"></script>
    <style>
        * {
            transition: all 0.3s ease;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            -webkit-touch-callout: none;
        }
        
        body {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .card-hover:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }
        
        .nav-item {
            position: relative;
            overflow: hidden;
        }
        
        .nav-item::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 0;
            height: 3px;
            background: linear-gradient(90deg, #3B82F6, #8B5CF6);
            transition: width 0.3s ease;
        }
        
        .nav-item:hover::before,
        .nav-item.active::before {
            width: 100%;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .room-card {
            transition: all 0.3s ease;
        }
        
        .room-card:hover {
            transform: scale(1.02);
        }
        
        .detail-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }
        
        .detail-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .slide-in {
            animation: slideIn 0.4s ease-out;
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            width: 100%;
        }
        
        .risk-matrix {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 2px;
            margin: 20px 0;
        }
        
        .risk-cell {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.75rem;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .risk-cell:hover {
            transform: scale(1.1);
            z-index: 10;
        }
        
        .risk-low { background-color: #10B981; }
        .risk-medium { background-color: #F59E0B; }
        .risk-high { background-color: #EF4444; }
        
        .footer-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .nav-text {
                font-size: 0.875rem;
            }
            .nav-item i {
                font-size: 1rem;
            }
        }
        
        @media (max-width: 640px) {
            .nav-text {
                display: none;
            }
            .nav-item i {
                font-size: 1.25rem;
            }
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* Notification badge */
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: #EF4444;
            color: white;
            font-size: 0.625rem;
            font-weight: bold;
            padding: 2px 4px;
            border-radius: 9999px;
        }
        
        /* Loading spinner */
        .spinner {
            border: 3px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top: 3px solid #3B82F6;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Blur overlay */
        .blur-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            backdrop-filter: blur(10px);
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .pin-container {
            background: white;
            padding: 2rem;
            border-radius: 10px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            text-align: center;
            max-width: 90%;
        }
        
        /* Small modal content */
        .small-modal-content {
            max-width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        
        /* Gallery styles */
        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
            padding: 1rem;
        }
        
        .gallery-item {
            position: relative;
            overflow: hidden;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: transform 0.3s ease;
        }
        
        .gallery-item:hover {
            transform: scale(1.05);
        }
        
        .gallery-item img {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }
        
        .gallery-item-info {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
            color: white;
            padding: 1rem;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }
        
        .gallery-item:hover .gallery-item-info {
            transform: translateY(0);
        }
        
        .gallery-filters {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            padding: 0.5rem 1rem;
            border: 1px solid #e5e7eb;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.875rem;
        }
        
        .filter-btn:hover {
            background: #f3f4f6;
        }
        
        .filter-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
        
        .image-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1001;
            animation: fadeIn 0.3s ease;
        }
        
        .image-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .image-modal-content {
            max-width: 90%;
            max-height: 90vh;
            position: relative;
        }
        
        .image-modal img {
            max-width: 100%;
            max-height: 90vh;
            object-fit: contain;
        }
        
        .image-modal-close {
            position: absolute;
            top: -40px;
            right: 0;
            color: white;
            font-size: 2rem;
            cursor: pointer;
        }
        
        /* Security overlay */
        .security-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 10000;
            display: none;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            text-align: center;
            padding: 2rem;
        }
        
        .security-overlay.active {
            display: flex;
        }
        
        /* Device warning */
        .device-warning {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #ef4444;
            color: white;
            padding: 1rem;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 9998;
            display: none;
            max-width: 300px;
        }
        
        .device-warning.active {
            display: block;
        }
        
        /* Print prevention */
        @media print {
            body * {
                visibility: hidden;
            }
            #securityOverlay, #securityOverlay * {
                visibility: visible;
            }
            #securityOverlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: white;
                z-index: 99999;
                display: flex;
                align-items: center;
                justify-content: center;
                flex-direction: column;
            }
        }
        
        /* New styles for improved UI */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            z-index: 10002;
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }
        
        .loading-overlay.active {
            display: flex;
        }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .shake-animation {
            animation: shake 0.5s;
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }
        
        .tooltip {
            position: relative;
        }
        
        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }
        
        .tooltip:hover::after {
            opacity: 1;
        }
        
        .fade-out {
            animation: fadeOut 0.3s ease-out forwards;
        }
        
        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }
        
        /* PIN input styles */
        .pin-input-container {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
        }
        
        .pin-input {
            width: 50px;
            height: 50px;
            text-align: center;
            font-size: 24px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .pin-input:focus {
            border-color: #3b82f6;
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        
        .pin-input.filled {
            border-color: #10b981;
            background-color: #f0fdf4;
        }
        
        /* Time display styles */
        .time-display {
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 5px 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        /* Dropdown menu styles */
        .dropdown-menu {
            position: absolute;
            top: 100%;
            right: 0;
            background: white;
            border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            min-width: 200px;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-10px);
            transition: all 0.3s ease;
            z-index: 100;
        }
        
        .dropdown-menu.active {
            opacity: 1;
            visibility: visible;
            transform: translateY(0);
        }
        
        .dropdown-item {
            padding: 10px 15px;
            border-bottom: 1px solid #f3f4f6;
            cursor: pointer;
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .dropdown-item:hover {
            background-color: #f9fafb;
        }
        
        .dropdown-item:last-child {
            border-bottom: none;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">
    <!-- Security Overlay -->
    <div id="securityOverlay" class="security-overlay">
        <i class="fas fa-lock text-6xl mb-4"></i>
        <h2 class="text-2xl font-bold mb-2">Akses Ditolak</h2>
        <p>Sistem tidak mengizinkan tangkapan layar atau screenshot untuk menjaga keamanan data.</p>
        <p class="mt-4 text-sm opacity-80">Silakan tutup halaman ini jika Anda tidak memiliki izin.</p>
    </div>

    <!-- Device Warning -->
    <div id="deviceWarning" class="device-warning">
        <div class="flex items-start">
            <i class="fas fa-exclamation-triangle mr-2 mt-1"></i>
            <div>
                <h4 class="font-semibold">Peringatan Perangkat</h4>
                <p class="text-sm">Sistem mendeteksi login dari perangkat lain. Sesi ini akan diakhiri.</p>
            </div>
        </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay">
        <div class="spinner mb-4"></div>
        <p class="text-gray-700">Memuat data...</p>
    </div>

    <!-- Blur Overlay with PIN -->
    <div id="blurOverlay" class="blur-overlay">
        <div class="pin-container">
            <h2 class="text-xl font-bold mb-4">Masukkan PIN untuk Akses</h2>
            <div class="pin-input-container">
                <input type="password" class="pin-input" maxlength="1" onkeyup="moveToNext(this, 0)">
                <input type="password" class="pin-input" maxlength="1" onkeyup="moveToNext(this, 1)">
                <input type="password" class="pin-input" maxlength="1" onkeyup="moveToNext(this, 2)">
                <input type="password" class="pin-input" maxlength="1" onkeyup="moveToNext(this, 3)">
                <input type="password" class="pin-input" maxlength="1" onkeyup="moveToNext(this, 4)">
                <input type="password" class="pin-input" maxlength="1" onkeyup="moveToNext(this, 5)">
            </div>
            <button onclick="checkPin()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 w-full">
                <i class="fas fa-check-circle mr-2"></i>Verifikasi
            </button>
            <div id="pinError" class="text-red-500 text-xs mt-2 hidden">PIN salah. Silakan coba lagi.</div>
        </div>
    </div>

    <!-- Header -->
    <header class="gradient-bg text-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-2">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
                <div class="mb-2 md:mb-0">
                    <h1 class="text-lg md:text-xl font-bold cursor-pointer" onclick="showReport('dashboard')">
                        Laporan K3RS/MFK
                    </h1>
                    <p class="text-xs md:text-sm opacity-90">Sistem Monitoring K3RS/MFK</p>
                </div>
                
                <div class="flex items-center space-x-2 w-full md:w-auto">
                    <div class="time-display">
                        <span id="clock">00:00:00</span>
                    </div>
                    
                    <div class="relative">
                        <button class="bg-white bg-opacity-20 px-3 py-1 rounded-lg hover:bg-opacity-30 text-xs md:text-sm relative flex items-center gap-2" onclick="toggleDropdown()">
                            <i class="fas fa-ellipsis-v"></i>
                            <span class="hidden md:inline">Menu</span>
                            <span class="notification-badge">3</span>
                        </button>
                        
                        <div id="dropdownMenu" class="dropdown-menu">
                            <div class="dropdown-item" onclick="showReport('dashboard')">
                                <i class="fas fa-tachometer-alt"></i>
                                <span>Dashboard</span>
                            </div>
                            <div class="dropdown-item" onclick="showReport('risiko')">
                                <i class="fas fa-exclamation-triangle"></i>
                                <span>Manajemen Risiko</span>
                            </div>
                            <div class="dropdown-item" onclick="showReport('kebakaran')">
                                <i class="fas fa-fire"></i>
                                <span>Manajemen Kebakaran</span>
                            </div>
                            <div class="dropdown-item" onclick="showReport('bencana')">
                                <i class="fas fa-cloud-showers-heavy"></i>
                                <span>Manajemen Bencana</span>
                            </div>
                            <div class="dropdown-item" onclick="showReport('keamanan')">
                                <i class="fas fa-shield-alt"></i>
                                <span>Manajemen Keamanan</span>
                            </div>
                            <div class="dropdown-item" onclick="showReport('b3')">
                                <i class="fas fa-flask"></i>
                                <span>Manajemen B3</span>
                            </div>
                            <div class="dropdown-item" onclick="showReport('fasilitas')">
                                <i class="fas fa-building"></i>
                                <span>Manajemen Fasilitas</span>
                            </div>
                            <div class="dropdown-item" onclick="showReport('galeri')">
                                <i class="fas fa-images"></i>
                                <span>Galeri Kegiatan</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-6 flex-grow">
        <!-- Dashboard -->
        <div id="dashboard" class="report-content fade-in">
            <h2 class="text-xl font-bold text-gray-800 mb-6">Dashboard K3RS/MFK</h2>
            
            <!-- Summary Cards -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                <div class="card-hover bg-white rounded-xl shadow-md p-4">
                    <div class="flex items-center justify-between mb-3">
                        <div class="bg-blue-100 p-2 rounded-lg">
                            <i class="fas fa-exclamation-triangle text-blue-600 text-xl"></i>
                        </div>
                        <span class="text-xs text-gray-500">Total Risiko</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800">156</h3>
                    <p class="text-xs text-gray-600 mt-1">24 ruangan</p>
                </div>
                
                <div class="card-hover bg-white rounded-xl shadow-md p-4">
                    <div class="flex items-center justify-between mb-3">
                        <div class="bg-red-100 p-2 rounded-lg">
                            <i class="fas fa-fire text-red-600 text-xl"></i>
                        </div>
                        <span class="text-xs text-gray-500">Kebakaran</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800">24</h3>
                    <p class="text-xs text-gray-600 mt-1">Insiden terdeteksi</p>
                </div>
                
                <div class="card-hover bg-white rounded-xl shadow-md p-4">
                    <div class="flex items-center justify-between mb-3">
                        <div class="bg-green-100 p-2 rounded-lg">
                            <i class="fas fa-check-circle text-green-600 text-xl"></i>
                        </div>
                        <span class="text-xs text-gray-500">Kepatuhan</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800">87%</h3>
                    <p class="text-xs text-gray-600 mt-1">Rata-rata</p>
                </div>
                
                <div class="card-hover bg-white rounded-xl shadow-md p-4">
                    <div class="flex items-center justify-between mb-3">
                        <div class="bg-purple-100 p-2 rounded-lg">
                            <i class="fas fa-tools text-purple-600 text-xl"></i>
                        </div>
                        <span class="text-xs text-gray-500">Pemeliharaan</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800">89%</h3>
                    <p class="text-xs text-gray-600 mt-1">Fasilitas baik</p>
                </div>
            </div>

            <!-- Monthly Trend Chart -->
            <div class="bg-white rounded-xl shadow-md p-4 mb-6">
                <h3 class="text-lg font-semibold text-gray-800 mb-3">Tren K3RS Bulanan</h3>
                <div class="chart-container">
                    <canvas id="trendChart"></canvas>
                </div>
            </div>

            <!-- Quick Links -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-white rounded-xl shadow-md p-4">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3">Ruangan dengan Risiko Tertinggi</h3>
                    <div class="space-y-2">
                        <div class="flex items-center justify-between p-2 bg-red-50 rounded-lg">
                            <span class="font-medium text-sm">IGD</span>
                            <span class="text-xs text-red-600">18 risiko</span>
                        </div>
                        <div class="flex items-center justify-between p-2 bg-orange-50 rounded-lg">
                            <span class="font-medium text-sm">ICU</span>
                            <span class="text-xs text-orange-600">15 risiko</span>
                        </div>
                        <div class="flex items-center justify-between p-2 bg-yellow-50 rounded-lg">
                            <span class="font-medium text-sm">LABORATORIUM</span>
                            <span class="text-xs text-yellow-600">12 risiko</span>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-md p-4">
                    <h3 class="text-lg font-semibold text-gray-800 mb-3">Kategori K3RS Terbaik</h3>
                    <div class="space-y-2">
                        <div class="flex items-center justify-between p-2 bg-green-50 rounded-lg">
                            <span class="font-medium text-sm">Keamanan</span>
                            <span class="text-xs text-green-600">94% kepatuhan</span>
                        </div>
                        <div class="flex items-center justify-between p-2 bg-green-50 rounded-lg">
                            <span class="font-medium text-sm">Kebakaran</span>
                            <span class="text-xs text-green-600">91% kepatuhan</span>
                        </div>
                        <div class="flex items-center justify-between p-2 bg-blue-50 rounded-lg">
                            <span class="font-medium text-sm">Fasilitas</span>
                            <span class="text-xs text-blue-600">89% kepatuhan</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Galeri Kegiatan -->
        <div id="galeri" class="report-content hidden">
            <h2 class="text-xl font-bold text-gray-800 mb-6">Galeri Kegiatan K3RS</h2>
            
            <!-- Filter Buttons -->
            <div class="gallery-filters">
                <button class="filter-btn active" onclick="filterGallery('all')">Semua</button>
                <button class="filter-btn" onclick="filterGallery('kebakaran')">Kebakaran</button>
                <button class="filter-btn" onclick="filterGallery('bencana')">Bencana</button>
                <button class="filter-btn" onclick="filterGallery('keamanan')">Keamanan</button>
                <button class="filter-btn" onclick="filterGallery('fasilitas')">Fasilitas</button>
            </div>
            
            <!-- Gallery Grid -->
            <div class="gallery-grid" id="galleryGrid">
                <!-- Gallery items will be inserted here -->
            </div>
        </div>

        <!-- Laporan Manajemen Risiko -->
        <div id="risiko" class="report-content hidden">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800 mb-2 md:mb-0">Laporan Manajemen Risiko</h2>
                <div class="flex items-center space-x-2 w-full md:w-auto">
                    <div class="relative w-full md:w-auto">
                        <input type="text" id="riskSearch" placeholder="Cari ruangan..." class="w-full px-3 py-1 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                        <i class="fas fa-search absolute right-3 top-2 text-gray-400 text-xs"></i>
                    </div>
                    <button class="bg-blue-600 text-white px-3 py-1 rounded-lg hover:bg-blue-700 text-sm">
                        <i class="fas fa-filter mr-1"></i>Filter
                    </button>
                </div>
            </div>
            
            <!-- Monthly Tabs -->
            <div class="bg-white rounded-xl shadow-md p-4 mb-4">
                <div class="flex flex-wrap gap-1 mb-3">
                    <button class="month-tab px-3 py-1 rounded-lg bg-blue-600 text-white text-xs" onclick="showMonthlyRisiko('jan')">Jan</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyRisiko('feb')">Feb</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyRisiko('mar')">Mar</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyRisiko('apr')">Apr</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyRisiko('mei')">Mei</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyRisiko('jun')">Jun</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyRisiko('jul')">Jul</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyRisiko('agu')">Agu</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyRisiko('sep')">Sep</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyRisiko('okt')">Okt</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyRisiko('nov')">Nov</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyRisiko('des')">Des</button>
                </div>

                <!-- Room Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3" id="risikoGrid">
                    <!-- Ruangan akan diisi oleh JavaScript -->
                </div>
            </div>
        </div>

        <!-- Laporan Manajemen Kebakaran -->
        <div id="kebakaran" class="report-content hidden">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800 mb-2 md:mb-0">Laporan Manajemen Kebakaran</h2>
                <div class="flex items-center space-x-2 w-full md:w-auto">
                    <div class="relative w-full md:w-auto">
                        <input type="text" id="fireSearch" placeholder="Cari ruangan..." class="w-full px-3 py-1 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                        <i class="fas fa-search absolute right-3 top-2 text-gray-400 text-xs"></i>
                    </div>
                    <button class="bg-red-600 text-white px-3 py-1 rounded-lg hover:bg-red-700 text-sm">
                        <i class="fas fa-filter mr-1"></i>Filter
                    </button>
                </div>
            </div>
            
            <!-- Monthly Tabs -->
            <div class="bg-white rounded-xl shadow-md p-4 mb-4">
                <div class="flex flex-wrap gap-1 mb-3">
                    <button class="month-tab px-3 py-1 rounded-lg bg-red-600 text-white text-xs" onclick="showMonthlyKebakaran('jan')">Jan</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKebakaran('feb')">Feb</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKebakaran('mar')">Mar</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKebakaran('apr')">Apr</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKebakaran('mei')">Mei</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKebakaran('jun')">Jun</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKebakaran('jul')">Jul</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKebakaran('agu')">Agu</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKebakaran('sep')">Sep</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKebakaran('okt')">Okt</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKebakaran('nov')">Nov</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKebakaran('des')">Des</button>
                </div>

                <!-- Room Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3" id="kebakaranGrid">
                    <!-- Ruangan akan diisi oleh JavaScript -->
                </div>
            </div>
        </div>

        <!-- Laporan Manajemen Bencana -->
        <div id="bencana" class="report-content hidden">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800 mb-2 md:mb-0">Laporan Manajemen Bencana</h2>
                <div class="flex items-center space-x-2 w-full md:w-auto">
                    <div class="relative w-full md:w-auto">
                        <input type="text" id="disasterSearch" placeholder="Cari ruangan..." class="w-full px-3 py-1 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                        <i class="fas fa-search absolute right-3 top-2 text-gray-400 text-xs"></i>
                    </div>
                    <button class="bg-purple-600 text-white px-3 py-1 rounded-lg hover:bg-purple-700 text-sm">
                        <i class="fas fa-filter mr-1"></i>Filter
                    </button>
                </div>
            </div>
            
            <!-- Monthly Tabs -->
            <div class="bg-white rounded-xl shadow-md p-4 mb-4">
                <div class="flex flex-wrap gap-1 mb-3">
                    <button class="month-tab px-3 py-1 rounded-lg bg-purple-600 text-white text-xs" onclick="showMonthlyBencana('jan')">Jan</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyBencana('feb')">Feb</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyBencana('mar')">Mar</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyBencana('apr')">Apr</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyBencana('mei')">Mei</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyBencana('jun')">Jun</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyBencana('jul')">Jul</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyBencana('agu')">Agu</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyBencana('sep')">Sep</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyBencana('okt')">Okt</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyBencana('nov')">Nov</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyBencana('des')">Des</button>
                </div>

                <!-- Room Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3" id="bencanaGrid">
                    <!-- Ruangan akan diisi oleh JavaScript -->
                </div>
            </div>
        </div>

        <!-- Laporan Manajemen Keamanan -->
        <div id="keamanan" class="report-content hidden">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800 mb-2 md:mb-0">Laporan Manajemen Keamanan</h2>
                <div class="flex items-center space-x-2 w-full md:w-auto">
                    <div class="relative w-full md:w-auto">
                        <input type="text" id="securitySearch" placeholder="Cari ruangan..." class="w-full px-3 py-1 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                        <i class="fas fa-search absolute right-3 top-2 text-gray-400 text-xs"></i>
                    </div>
                    <button class="bg-green-600 text-white px-3 py-1 rounded-lg hover:bg-green-700 text-sm">
                        <i class="fas fa-filter mr-1"></i>Filter
                    </button>
                </div>
            </div>
            
            <!-- Monthly Tabs -->
            <div class="bg-white rounded-xl shadow-md p-4 mb-4">
                <div class="flex flex-wrap gap-1 mb-3">
                    <button class="month-tab px-3 py-1 rounded-lg bg-green-600 text-white text-xs" onclick="showMonthlyKeamanan('jan')">Jan</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKeamanan('feb')">Feb</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKeamanan('mar')">Mar</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKeamanan('apr')">Apr</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKeamanan('mei')">Mei</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKeamanan('jun')">Jun</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKeamanan('jul')">Jul</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKeamanan('agu')">Agu</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKeamanan('sep')">Sep</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKeamanan('okt')">Okt</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKeamanan('nov')">Nov</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyKeamanan('des')">Des</button>
                </div>

                <!-- Room Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3" id="keamananGrid">
                    <!-- Ruangan akan diisi oleh JavaScript -->
                </div>
            </div>
        </div>

        <!-- Laporan Manajemen B3 -->
        <div id="b3" class="report-content hidden">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800 mb-2 md:mb-0">Laporan Manajemen B3</h2>
                <div class="flex items-center space-x-2 w-full md:w-auto">
                    <div class="relative w-full md:w-auto">
                        <input type="text" id="b3Search" placeholder="Cari ruangan..." class="w-full px-3 py-1 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                        <i class="fas fa-search absolute right-3 top-2 text-gray-400 text-xs"></i>
                    </div>
                    <button class="bg-yellow-600 text-white px-3 py-1 rounded-lg hover:bg-yellow-700 text-sm">
                        <i class="fas fa-filter mr-1"></i>Filter
                    </button>
                </div>
            </div>
            
            <!-- Monthly Tabs -->
            <div class="bg-white rounded-xl shadow-md p-4 mb-4">
                <div class="flex flex-wrap gap-1 mb-3">
                    <button class="month-tab px-3 py-1 rounded-lg bg-yellow-600 text-white text-xs" onclick="showMonthlyB3('jan')">Jan</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyB3('feb')">Feb</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyB3('mar')">Mar</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyB3('apr')">Apr</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyB3('mei')">Mei</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyB3('jun')">Jun</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyB3('jul')">Jul</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyB3('agu')">Agu</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyB3('sep')">Sep</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyB3('okt')">Okt</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyB3('nov')">Nov</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyB3('des')">Des</button>
                </div>

                <!-- Room Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3" id="b3Grid">
                    <!-- Ruangan akan diisi oleh JavaScript -->
                </div>
            </div>
        </div>

        <!-- Laporan Manajemen Fasilitas -->
        <div id="fasilitas" class="report-content hidden">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-4">
                <h2 class="text-xl font-bold text-gray-800 mb-2 md:mb-0">Laporan Manajemen Fasilitas</h2>
                <div class="flex items-center space-x-2 w-full md:w-auto">
                    <div class="relative w-full md:w-auto">
                        <input type="text" id="facilitySearch" placeholder="Cari ruangan..." class="w-full px-3 py-1 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm">
                        <i class="fas fa-search absolute right-3 top-2 text-gray-400 text-xs"></i>
                    </div>
                    <button class="bg-indigo-600 text-white px-3 py-1 rounded-lg hover:bg-indigo-700 text-sm">
                        <i class="fas fa-filter mr-1"></i>Filter
                    </button>
                </div>
            </div>
            
            <!-- Monthly Tabs -->
            <div class="bg-white rounded-xl shadow-md p-4 mb-4">
                <div class="flex flex-wrap gap-1 mb-3">
                    <button class="month-tab px-3 py-1 rounded-lg bg-indigo-600 text-white text-xs" onclick="showMonthlyFasilitas('jan')">Jan</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyFasilitas('feb')">Feb</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyFasilitas('mar')">Mar</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyFasilitas('apr')">Apr</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyFasilitas('mei')">Mei</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyFasilitas('jun')">Jun</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyFasilitas('jul')">Jul</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyFasilitas('agu')">Agu</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyFasilitas('sep')">Sep</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyFasilitas('okt')">Okt</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyFasilitas('nov')">Nov</button>
                    <button class="month-tab px-3 py-1 rounded-lg bg-gray-200 text-gray-700 hover:bg-gray-300 text-xs" onclick="showMonthlyFasilitas('des')">Des</button>
                </div>

                <!-- Room Grid -->
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3" id="fasilitasGrid">
                    <!-- Ruangan akan diisi oleh JavaScript -->
                </div>
            </div>
        </div>
    </main>

    <!-- Detail Modal -->
    <div id="detailModal" class="detail-modal">
        <div class="bg-white rounded-xl shadow-2xl p-4 small-modal-content">
            <div class="flex justify-between items-center mb-3">
                <h3 class="text-lg font-bold text-gray-800" id="modalTitle">Detail Laporan</h3>
                <button onclick="closeModal()" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div id="modalContent">
                <!-- Detail content will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Image Modal -->
    <div id="imageModal" class="image-modal">
        <div class="image-modal-content">
            <span class="image-modal-close" onclick="closeImageModal()">&times;</span>
            <img id="modalImage" src="" alt="">
            <div class="text-white text-center mt-4">
                <p id="modalImageTitle" class="text-lg font-semibold"></p>
                <p id="modalImageDescription" class="text-sm opacity-80 mt-2"></p>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer-gradient text-white py-4 mt-auto">
        <div class="container mx-auto px-4 text-center">
            <p class="text-xs">Di kembangkan oleh Jhosua V. Malendes, S.K.M</p>
            <p class="text-xs mt-1"> 2024 Rumah Sakit Umum Daerah Talaud | Jln. Raya Mala-Melonguane, Talaud, Sulawesi Utara</p>
        </div>
    </footer>

    <script>
        // Device fingerprinting
        let deviceFingerprint = '';
        let sessionValid = false;
        
        // Initialize fingerprint
        async function initFingerprint() {
            const fp = await FingerprintJS.load();
            const result = await fp.get();
            deviceFingerprint = result.visitorId;
            localStorage.setItem('deviceFingerprint', deviceFingerprint);
            checkDevice();
        }
        
        // Check device fingerprint
        function checkDevice() {
            const storedFingerprint = localStorage.getItem('deviceFingerprint');
            if (storedFingerprint && storedFingerprint !== deviceFingerprint) {
                // Device changed
                showDeviceWarning();
                setTimeout(() => {
                    logout();
                }, 3000);
            } else {
                sessionValid = true;
            }
        }
        
        // Show device warning
        function showDeviceWarning() {
            const warning = document.getElementById('deviceWarning');
            warning.classList.add('active');
            setTimeout(() => {
                warning.classList.remove('active');
            }, 5000);
        }
        
        // Logout function
        function logout() {
            sessionValid = false;
            localStorage.removeItem('sessionValid');
            document.getElementById('blurOverlay').style.display = 'flex';
        }
        
        // Check for screenshot attempts
        function preventScreenshot() {
            // Disable print
            window.addEventListener('beforeprint', () => {
                document.getElementById('securityOverlay').classList.add('active');
            });
            
            window.addEventListener('afterprint', () => {
                document.getElementById('securityOverlay').classList.remove('active');
            });
            
            // Disable keyboard shortcuts for screenshots
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.key === 'p') {
                    e.preventDefault();
                    document.getElementById('securityOverlay').classList.add('active');
                    setTimeout(() => {
                        document.getElementById('securityOverlay').classList.remove('active');
                    }, 2000);
                }
            });
            
            // Disable context menu (right-click)
            document.addEventListener('contextmenu', (e) => {
                e.preventDefault();
            });
            
            // Disable drag and drop
            document.addEventListener('dragstart', (e) => {
                e.preventDefault();
            });
        }
        
        // PIN verification with better validation
        function checkPin() {
            const pinInputs = document.querySelectorAll('.pin-input');
            const pinError = document.getElementById('pinError');
            const blurOverlay = document.getElementById('blurOverlay');
            
            let pinValue = '';
            pinInputs.forEach(input => {
                pinValue += input.value;
            });
            
            if (pinValue.length !== 6) {
                pinInputs.forEach(input => {
                    input.classList.add('shake-animation');
                });
                setTimeout(() => {
                    pinInputs.forEach(input => {
                        input.classList.remove('shake-animation');
                    });
                }, 500);
                return;
            }
            
            if (pinValue === '291196') {
                blurOverlay.style.display = 'none';
                localStorage.setItem('sessionValid', 'true');
                sessionValid = true;
                initFingerprint();
                pinError.classList.add('hidden');
                
                // Mark filled inputs
                pinInputs.forEach(input => {
                    input.classList.add('filled');
                });
            } else {
                pinInputs.forEach(input => {
                    input.classList.add('shake-animation');
                });
                setTimeout(() => {
                    pinInputs.forEach(input => {
                        input.classList.remove('shake-animation');
                    });
                }, 500);
                pinError.classList.remove('hidden');
            }
        }
        
        // Move to next PIN input
        function moveToNext(current, index) {
            if (current.value.length === 1 && index < 5) {
                const nextInput = document.querySelectorAll('.pin-input')[index + 1];
                nextInput.focus();
            }
            
            // Check if all inputs are filled
            const allInputs = document.querySelectorAll('.pin-input');
            const allFilled = Array.from(allInputs).every(input => input.value.length === 1);
            
            if (allFilled) {
                checkPin();
            }
        }
        
        // Toggle dropdown menu
        function toggleDropdown() {
            const dropdown = document.getElementById('dropdownMenu');
            dropdown.classList.toggle('active');
        }
        
        // Close dropdown when clicking outside
        document.addEventListener('click', function(event) {
            const dropdown = document.getElementById('dropdownMenu');
            const button = event.target.closest('button');
            
            if (!button || !button.onclick || button.onclick.toString().indexOf('toggleDropdown') === -1) {
                dropdown.classList.remove('active');
            }
        });

        // Gallery data
        const galleryData = [
            {
                id: 1,
                title: "Inspeksi Kebakaran",
                description: "Tim K3RS melakukan inspeksi rutin pada sistem kebakaran",
                category: "kebakaran",
                image: "https://z-cdn-media.chatglm.cn/files/dbcad338-972d-4d3e-ad22-55a77b631623_image_2025-11-08_10-32-20.jpg?auth_key=1864024247-6006c6c0c8d240d48000abc6410a0b73-0-8a9fdcb30e3a6a5d49095dc2745887b5",
                date: "08/07/2024"
            },
            {
                id: 2,
                title: "Kegiatan Evakuasi",
                description: "Simulasi evakuasi darurat untuk mengantisipasi bencana",
                category: "bencana",
                image: "https://z-cdn-media.chatglm.cn/files/3b53d5c8-2fa0-4499-adf3-68bfc6859eae_image_2025-11-08_10-34-45.jpg?auth_key=1864024247-f1736f746b1c48b59a5e0f072728d26c-0-b4a85564e0a39b234c99c2c7af386cb7",
                date: "08/07/2024"
            },
            {
                id: 3,
                title: "Pemeriksaan APAR",
                description: "Pemeriksaan alat pemadam api ringan (APAR) di berbagai lokasi",
                category: "kebakaran",
                image: "https://z-cdn-media.chatglm.cn/files/81e22945-66aa-444b-9887-4dc3b54b09cc_Gambar%20WhatsApp%202024-07-09%20pukul%2003.46.38_e05dce3c.jpg?auth_key=1864024247-b7c0fbc8e6ee42ba802ab5d6a843cee9-0-34a239f8c26b1a9f2303dddb1d4f5d77",
                date: "08/07/2024"
            },
            {
                id: 4,
                title: "SOP Kebakaran",
                description: "Pelatihan standar operasional prosedur kebakaran",
                category: "kebakaran",
                image: "https://z-cdn-media.chatglm.cn/files/3590e765-d758-4e3c-8b1d-cdf09fc31fcc_Gambar%20WhatsApp%202024-07-09%20pukul%2003.46.39_2aadbb72.jpg?auth_key=1864024247-3207ae00ccfe431084f126a5d899ae07-0-3f5a1fe1c8b19465f27e4af5acc806b7",
                date: "08/07/2024"
            },
            {
                id: 5,
                title: "Instalasi Gawat Darurat",
                description: "Tim K3RS bersama tim medis di instalasi gawat darurat",
                category: "fasilitas",
                image: "https://z-cdn-media.chatglm.cn/files/9dece0de-4005-4fc6-81e5-ffeb4f55fd17_Gambar%20WhatsApp%202024-07-09%20pukul%2003.46.39_552b8122.jpg?auth_key=1864024247-70534329ea6743c6bfc93caa214e2929-0-70462578f9bc7c2a55f5886c3aea4866",
                date: "08/07/2024"
            },
            {
                id: 6,
                title: "Simulasi Kebakaran",
                description: "Simulasi penanggulangan kebakaran di area laboratorium",
                category: "kebakaran",
                image: "https://z-cdn-media.chatglm.cn/files/1fe7e6d4-f97b-49ba-8d19-be97a462b8ab_Gambar%20WhatsApp%202024-07-09%20pukul%2003.46.42_baedbeec.jpg?auth_key=1864024247-a89c77198f6e43f8b24794a9a40bceab-0-2ed94376c27858bac53522d143f4dcc3",
                date: "08/07/2024"
            },
            {
                id: 7,
                title: "Pemeriksaan Keamanan",
                description: "Tim keamanan melakukan patroli di area kritis",
                category: "keamanan",
                image: "https://z-cdn-media.chatglm.cn/files/a0b1ac9c-133f-4c02-a021-3f24b9375626_Gambar%20WhatsApp%202024-07-09%20pukul%2003.46.43_4bb1e586.jpg?auth_key=1864024247-1b05a3f2db8f48a8a3c7b5b219bc48b9-0-ebe994467440e740d0eceaa4f34cea27",
                date: "08/07/2024"
            },
            {
                id: 8,
                title: "Tim Tanggap Darurat",
                description: "Foto bersama tim tanggap darurat RSUD Talaud",
                category: "bencana",
                image: "https://z-cdn-media.chatglm.cn/files/deef1b58-a485-4fee-9b45-6b9852628f0f_Gambar%20WhatsApp%202024-07-09%20pukul%2003.46.06_404016de.jpg?auth_key=1864024247-f59bb4c9c7a84537af1a80353ea79082-0-1fd573511b01160e7e54154968f25115",
                date: "08/07/2024"
            }
        ];

        // Initialize gallery
        function initGallery() {
            const galleryGrid = document.getElementById('galleryGrid');
            galleryGrid.innerHTML = galleryData.map(item => `
                <div class="gallery-item" data-category="${item.category}" onclick="openImageModal(${item.id})">
                    <img src="${item.image}" alt="${item.title}" loading="lazy">
                    <div class="gallery-item-info">
                        <h4 class="font-semibold text-sm">${item.title}</h4>
                        <p class="text-xs opacity-90">${item.date}</p>
                    </div>
                </div>
            `).join('');
        }

        // Filter gallery
        function filterGallery(category) {
            const items = document.querySelectorAll('.gallery-item');
            const buttons = document.querySelectorAll('.filter-btn');
            
            // Update active button
            buttons.forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.toLowerCase().includes(category) || 
                    (category === 'all' && btn.textContent === 'Semua')) {
                    btn.classList.add('active');
                }
            });
            
            // Filter items
            items.forEach(item => {
                if (category === 'all' || item.dataset.category === category) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }

        // Open image modal
        function openImageModal(id) {
            const item = galleryData.find(g => g.id === id);
            if (item) {
                document.getElementById('modalImage').src = item.image;
                document.getElementById('modalImageTitle').textContent = item.title;
                document.getElementById('modalImageDescription').textContent = `${item.description} - ${item.date}`;
                document.getElementById('imageModal').classList.add('active');
            }
        }

        // Close image modal
        function closeImageModal() {
            document.getElementById('imageModal').classList.remove('active');
        }

        // Data untuk ruangan-ruangan
        const rooms = [
            'ANGGREK', 'APOTEK/FARMASI', 'BINATU', 'CRYSANT', 'DAHLIA', 
            'EDELWEIS', 'FISIOTERAPI', 'GUDANG APOTEK', 'IBS', 'ICU', 
            'IGD', 'IGD VK', 'INSTALASI GIZI', 'IPSRS', 'ISOLASI', 
            'KANTOR', 'LABORATORIUM', 'MEDREC', 'NICU', 'PEMULASARAN JENAZAH', 
            'POLIKLINIK', 'POS SATPAM', 'RADIOLODI'
        ];

        // Generate random data for demonstration
        function generateRandomData(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        // Current year
        let currentYear = 2024;

        // Show report function
        function showReport(reportId) {
            // Check session validity
            if (!sessionValid) {
                logout();
                return;
            }
            
            // Close dropdown menu
            document.getElementById('dropdownMenu').classList.remove('active');
            
            // Show loading overlay
            document.getElementById('loadingOverlay').classList.add('active');
            
            const reports = document.querySelectorAll('.report-content');
            reports.forEach(report => {
                report.classList.add('hidden');
                report.classList.remove('fade-in');
            });

            const selectedReport = document.getElementById(reportId);
            if (selectedReport) {
                selectedReport.classList.remove('hidden');
                setTimeout(() => {
                    selectedReport.classList.add('fade-in');
                    // Hide loading overlay after fade-in
                    document.getElementById('loadingOverlay').classList.remove('active');
                }, 10);
            }

            // Initialize chart for dashboard
            if (reportId === 'dashboard') {
                initTrendChart();
            }
            
            // Initialize gallery for galeri page
            if (reportId === 'galeri') {
                initGallery();
            }
        }

        // Initialize trend chart
        function initTrendChart() {
            const ctx = document.getElementById('trendChart').getContext('2d');
            window.trendChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'Mei', 'Jun', 'Jul', 'Agu', 'Sep', 'Okt', 'Nov', 'Des'],
                    datasets: [{
                        label: 'Kepatuhan K3RS (%)',
                        data: [82, 84, 85, 83, 86, 87, 88, 87, 89, 88, 87, 89],
                        backgroundColor: 'rgba(59, 130, 246, 0.8)',
                        borderColor: 'rgb(59, 130, 246)',
                        borderWidth: 1
                    }, {
                        label: 'Risiko Teridentifikasi (%)',
                        data: [75, 77, 78, 80, 82, 83, 84, 85, 86, 87, 88, 90],
                        backgroundColor: 'rgba(239, 68, 68, 0.8)',
                        borderColor: 'rgb(239, 68, 68)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // Show detail modal
        function showDetail(room, month, type) {
            const modal = document.getElementById('detailModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalContent = document.getElementById('modalContent');

            modalTitle.textContent = `Detail Laporan ${type} - ${room} - ${getMonthName(month)} ${currentYear}`;

            // Generate detailed content based on type
            let content = '';
            switch(type) {
                case 'Risiko':
                    content = generateRisikoDetail(room, month);
                    break;
                case 'Kebakaran':
                    content = generateKebakaranDetail(room, month);
                    break;
                case 'Bencana':
                    content = generateBencanaDetail(room, month);
                    break;
                case 'Keamanan':
                    content = generateKeamananDetail(room, month);
                    break;
                case 'B3':
                    content = generateB3Detail(room, month);
                    break;
                case 'Fasilitas':
                    content = generateFasilitasDetail(room, month);
                    break;
            }

            modalContent.innerHTML = content;
            modal.classList.add('active');
        }

        // Close modal
        function closeModal() {
            const modal = document.getElementById('detailModal');
            modal.classList.remove('active');
        }

        // Get month name
        function getMonthName(month) {
            const months = {
                'jan': 'Januari',
                'feb': 'Februari',
                'mar': 'Maret',
                'apr': 'April',
                'mei': 'Mei',
                'jun': 'Juni',
                'jul': 'Juli',
                'agu': 'Agustus',
                'sep': 'September',
                'okt': 'Oktober',
                'nov': 'November',
                'des': 'Desember'
            };
            return months[month] || month;
        }

        // Generate risk matrix
        function generateRiskMatrix(room, month) {
            const risks = [
                { name: 'Kerusakan Alat Medis', likelihood: 4, impact: 5, risk: 20 },
                { name: 'Infeksi Nosokomial', likelihood: 3, impact: 4, risk: 12 },
                { name: 'Kecelakaan Kerja', likelihood: 2, impact: 3, risk: 6 },
                { name: 'Kerusakan Infrastruktur', likelihood: 3, impact: 4, risk: 12 },
                { name: 'Kehilangan Data', likelihood: 2, impact: 5, risk: 10 }
            ];

            let matrixHtml = `
                <div class="mb-4">
                    <h4 class="text-md font-semibold mb-2">Matriks Risiko - ${room}</h4>
                    <div class="overflow-x-auto">
                        <table class="min-w-full border-collapse border border-gray-300 text-xs">
                            <thead>
                                <tr class="bg-gray-100">
                                    <th class="border border-gray-300 px-2 py-1 text-left">Risiko</th>
                                    <th class="border border-gray-300 px-2 py-1 text-center">Kemungkinan</th>
                                    <th class="border border-gray-300 px-2 py-1 text-center">Dampak</th>
                                    <th class="border border-gray-300 px-2 py-1 text-center">Skor Risiko</th>
                                    <th class="border border-gray-300 px-2 py-1 text-center">Mitigasi</th>
                                </tr>
                            </thead>
                            <tbody>
            `;

            risks.forEach(risk => {
                const riskColor = risk.risk >= 15 ? 'risk-high' : risk.risk >= 10 ? 'risk-medium' : 'risk-low';
                const mitigasi = getMitigation(risk.name);
                
                matrixHtml += `
                    <tr>
                        <td class="border border-gray-300 px-2 py-1 text-xs">${risk.name}</td>
                        <td class="border border-gray-300 px-2 py-1 text-center text-xs">${risk.likelihood}</td>
                        <td class="border border-gray-300 px-2 py-1 text-center text-xs">${risk.impact}</td>
                        <td class="border border-gray-300 px-2 py-1 text-center text-xs">
                            <span class="px-1 py-0.5 rounded ${riskColor} text-xs">${risk.risk}</span>
                        </td>
                        <td class="border border-gray-300 px-2 py-1 text-xs">${mitigasi}</td>
                    </tr>
                `;
            });

            matrixHtml += `
                            </tbody>
                        </table>
                    </div>
                </div>
            `;

            return matrixHtml;
        }

        // Get mitigation based on risk name
        function getMitigation(riskName) {
            const mitigations = {
                'Kerusakan Alat Medis': 'Perawatan rutin, kalibrasi berkala, training penggunaan',
                'Infeksi Nosokomial': 'Protokol sterilisasi, monitoring rutin, edukasi staff',
                'Kecelakaan Kerja': 'Pelatihan K3, inspeksi lingkungan, SOP jelas',
                'Kerusakan Infrastruktur': 'Inspeksi berkala, perbaikan cepat, rencana backup',
                'Kehilangan Data': 'Backup otomatis, enkripsi data, akses terbatas'
            };
            return mitigations[riskName] || 'Perlu ditindaklanjuti';
        }

        // Generate detailed reports
        function generateKebakaranDetail(room, month) {
            return `
                <div class="space-y-4">
                    <div class="bg-red-50 p-3 rounded-lg">
                        <h4 class="font-semibold text-red-900 mb-1 text-sm">Status Kebakaran</h4>
                        <p class="text-xs text-red-800">Pada bulan ${getMonthName(month)}, ruangan ${room} tidak memiliki AP 2kg, AP 9kg, AP kering, atau alarm kebakaran. Hanya jalur evakuasi yang tersedia.</p>
                    </div>
                    
                    ${generateRiskMatrix(room, month)}
                    
                    <div class="space-y-3">
                        <h4 class="font-semibold text-gray-800 text-sm">Pemeriksaan Kebakaran</h4>
                        <div class="grid grid-cols-2 gap-2">
                            <div class="border rounded-lg p-2">
                                <h5 class="font-medium mb-1 text-xs">AP 2 kg</h5>
                                <p class="text-xs text-gray-600">0 unit</p>
                            </div>
                            <div class="border rounded-lg p-2">
                                <h5 class="font-medium mb-1 text-xs">AP 9 kg</h5>
                                <p class="text-xs text-gray-600">0 unit</p>
                            </div>
                            <div class="border rounded-lg p-2">
                                <h5 class="font-medium mb-1 text-xs">AP Kering</h5>
                                <p class="text-xs text-gray-600">0 unit</p>
                            </div>
                            <div class="border rounded-lg p-2">
                                <h5 class="font-medium mb-1 text-xs">Alarm Kebakaran</h5>
                                <p class="text-xs text-gray-600">0 unit</p>
                            </div>
                            <div class="border rounded-lg p-2 col-span-2">
                                <h5 class="font-medium mb-1 text-xs">Jalur Evakuasi</h5>
                                <p class="text-xs text-gray-600">1 titik</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <h4 class="font-semibold text-gray-800 mb-1 text-sm">Rekomendasi</h4>
                        <ul class="text-xs text-gray-600 space-y-1">
                            <li> Segera pasang minimal 1 unit AP 2kg</li>
                            <li> Pertimbangkan untuk menambahkan AP 9kg</li>
                            <li> Pasang alarm kebakaran untuk keamanan maksimal</li>
                            <li> Pertahankan jalur evakuasi selalu bebas dari hambatan</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        function generateRisikoDetail(room, month) {
            return `
                <div class="space-y-4">
                    <div class="bg-blue-50 p-3 rounded-lg">
                        <h4 class="font-semibold text-blue-900 mb-1 text-sm">Ringkasan Risiko</h4>
                        <p class="text-xs text-blue-800">Pada bulan ${getMonthName(month)}, ruangan ${room} memiliki ${generateRandomData(1, 5)} risiko aktif yang perlu ditangani.</p>
                    </div>
                    
                    ${generateRiskMatrix(room, month)}
                    
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <h4 class="font-semibold text-gray-800 mb-1 text-sm">Rekomendasi</h4>
                        <ul class="text-xs text-gray-600 space-y-1">
                            <li> Lakukan inspeksi rutin pada ${getMonthName(month + 1)}</li>
                            <li> Perbarui SOP sesuai standar terbaru</li>
                            <li> Lakukan pelatihan khusus untuk staff</li>
                        </ul>
                    </div>
                </div>
            `;
        }

        function generateBencanaDetail(room, month) {
            return `
                <div class="space-y-4">
                    <div class="bg-purple-50 p-3 rounded-lg">
                        <h4 class="font-semibold text-purple-900 mb-1 text-sm">Kesiapan Bencana</h4>
                        <p class="text-xs text-purple-800">Ruangan ${room} siap menghadapi bencana alam dengan tingkat kesiapan ${generateRandomData(60, 95)}%</p>
                    </div>
                    
                    ${generateRiskMatrix(room, month)}
                    
                    <div class="space-y-3">
                        <h4 class="font-semibold text-gray-800 text-sm">Persediaan Darurat</h4>
                        <div class="grid grid-cols-3 gap-2">
                            <div class="border rounded-lg p-2 text-center">
                                <i class="fas fa-first-aid text-xl text-red-600 mb-1"></i>
                                <h5 class="font-medium text-xs">P3K</h5>
                                <p class="text-xs text-gray-600">Tidak tersedia</p>
                            </div>
                            <div class="border rounded-lg p-2 text-center">
                                <i class="fas fa-tshirt text-xl text-blue-600 mb-1"></i>
                                <h5 class="font-medium text-xs">Pakaian</h5>
                                <p class="text-xs text-gray-600">Selalu tersedia</p>
                            </div>
                            <div class="border rounded-lg p-2 text-center">
                                <i class="fas fa-utensils text-xl text-green-600 mb-1"></i>
                                <h5 class="font-medium text-xs">Makanan</h5>
                                <p class="text-xs text-gray-600">Selalu tersedia</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <h4 class="font-semibold text-gray-800 mb-1 text-sm">Prosedur Evakuasi</h4>
                        <p class="text-xs text-gray-600">Jalur evakuasi telah ditandai dengan jelas. Tim tanggap darurat telah dilatih.</p>
                    </div>
                </div>
            `;
        }

        function generateKeamananDetail(room, month) {
            return `
                <div class="space-y-4">
                    <div class="bg-green-50 p-3 rounded-lg">
                        <h4 class="font-semibold text-green-900 mb-1 text-sm">Status Keamanan</h4>
                        <p class="text-xs text-green-800">Keamanan ruangan ${room} dalam kondisi ${generateRandomData(80, 100)}% baik</p>
                    </div>
                    
                    ${generateRiskMatrix(room, month)}
                    
                    <div class="space-y-3">
                        <h4 class="font-semibold text-gray-800 text-sm">Sistem Keamanan</h4>
                        <div class="space-y-2">
                            <div class="flex justify-between items-center p-2 border rounded-lg">
                                <span class="text-sm">CCTV</span>
                                <span class="text-xs text-red-600">Tidak tersedia</span>
                            </div>
                            <div class="flex justify-between items-center p-2 border rounded-lg">
                                <span class="text-sm">Access Control</span>
                                <span class="text-xs text-green-600">Normal</span>
                            </div>
                            <div class="flex justify-between items-center p-2 border rounded-lg">
                                <span class="text-sm">Alarm Keamanan</span>
                                <span class="text-xs text-red-600">Tidak tersedia</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <h4 class="font-semibold text-gray-800 mb-1 text-sm">Patroli</h4>
                        <p class="text-xs text-gray-600">Patroli rutin dilakukan setiap hari</p>
                    </div>
                </div>
            `;
        }

        function generateB3Detail(room, month) {
            return `
                <div class="space-y-4">
                    <div class="bg-yellow-50 p-3 rounded-lg">
                        <h4 class="font-semibold text-yellow-900 mb-1 text-sm">Status B3</h4>
                        <p class="text-xs text-yellow-800">Pengelolaan B3 di ruangan ${room} sesuai standar ${generateRandomData(70, 100)}%</p>
                    </div>
                    
                    ${generateRiskMatrix(room, month)}
                    
                    <div class="space-y-3">
                        <h4 class="font-semibold text-gray-800 text-sm">Inventaris B3</h4>
                        <div class="grid grid-cols-2 gap-2">
                            <div class="border rounded-lg p-2">
                                <h5 class="font-medium mb-1 text-xs">Kimia Beracun</h5>
                                <p class="text-xs text-gray-600">${generateRandomData(1, 10)} jenis</p>
                            </div>
                            <div class="border rounded-lg p-2">
                                <h5 class="font-medium mb-1 text-xs">Radiokatif</h5>
                                <p class="text-xs text-gray-600">${generateRandomData(0, 3)} jenis</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <h4 class="font-semibold text-gray-800 mb-1 text-sm">Hasil Temuan</h4>
                        <p class="text-xs text-gray-600">Semua staf medis sudah membedakan jenis limbah medis dan non medis dengan baik. Proses pengelolaan limbah telah sesuai standar.</p>
                    </div>
                </div>
            `;
        }

        function generateFasilitasDetail(room, month) {
            return `
                <div class="space-y-4">
                    <div class="bg-indigo-50 p-3 rounded-lg">
                        <h4 class="font-semibold text-indigo-900 mb-1 text-sm">Status Fasilitas</h4>
                        <p class="text-xs text-indigo-800">Kondisi fasilitas di ${room} normal dan berfungsi dengan baik</p>
                    </div>
                    
                    ${generateRiskMatrix(room, month)}
                    
                    <div class="space-y-3">
                        <h4 class="font-semibold text-gray-800 text-sm">Pemeriksaan Fasilitas</h4>
                        <div class="space-y-2">
                            <div class="flex justify-between items-center p-2 border rounded-lg">
                                <span class="text-sm">AC</span>
                                <span class="text-xs text-green-600">Normal</span>
                            </div>
                            <div class="flex justify-between items-center p-2 border rounded-lg">
                                <span class="text-sm">Listrik</span>
                                <span class="text-xs text-green-600">Normal</span>
                            </div>
                            <div class="flex justify-between items-center p-2 border rounded-lg">
                                <span class="text-sm">Pipa Air</span>
                                <span class="text-xs text-green-600">Normal</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="bg-gray-50 p-3 rounded-lg">
                        <h4 class="font-semibold text-gray-800 mb-1 text-sm">Rencana Pemeliharaan</h4>
                        <p class="text-xs text-gray-600">Pemeliharaan berikutnya pada ${getMonthName(month)} ${generateRandomData(15, 30)}</p>
                    </div>
                </div>
            `;
        }

        // Show monthly reports for each category
        function showMonthlyKebakaran(month) {
            updateMonthTabs('kebakaran', month);
            const grid = document.getElementById('kebakaranGrid');
            
            grid.innerHTML = rooms.map(room => `
                <div class="room-card bg-white border rounded-lg p-3 cursor-pointer hover:shadow-lg" onclick="showDetail('${room}', '${month}', 'Kebakaran')">
                    <h4 class="font-semibold text-gray-800 mb-1 text-sm">${room}</h4>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-gray-600">Tidak ada AP</span>
                        <span class="text-xs bg-red-100 text-red-800">Perbaatan</span>
                    </div>
                </div>
            `).join('');
        }

        function showMonthlyRisiko(month) {
            updateMonthTabs('risiko', month);
            const grid = document.getElementById('risikoGrid');
            grid.innerHTML = rooms.map(room => `
                <div class="room-card bg-white border rounded-lg p-3 cursor-pointer hover:shadow-lg" onclick="showDetail('${room}', '${month}', 'Risiko')">
                    <h4 class="font-semibold text-gray-800 mb-1 text-sm">${room}</h4>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-gray-600">${generateRandomData(1, 5)} risiko</span>
                        <span class="text-xs ${getRiskColor(getRandomRiskLevel())}">${getRandomRiskLevel()}</span>
                    </div>
                </div>
            `).join('');
        }

        function showMonthlyBencana(month) {
            updateMonthTabs('bencana', month);
            const grid = document.getElementById('bencanaGrid');
            grid.innerHTML = rooms.map(room => `
                <div class="room-card bg-white border rounded-lg p-3 cursor-pointer hover:shadow-lg" onclick="showDetail('${room}', '${month}', 'Bencana')">
                    <h4 class="font-semibold text-gray-800 mb-1 text-sm">${room}</h4>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-gray-600">${generateRandomData(60, 95)}%</span>
                        <span class="text-xs bg-purple-100 text-purple-800">Siap</span>
                    </div>
                </div>
            `).join('');
        }

        function showMonthlyKeamanan(month) {
            updateMonthTabs('keamanan', month);
            const grid = document.getElementById('keamananGrid');
            grid.innerHTML = rooms.map(room => `
                <div class="room-card bg-white border rounded-lg p-3 cursor-pointer hover:shadow-lg" onclick="showDetail('${room}', '${month}', 'Keamanan')">
                    <h4 class="font-semibold text-gray-800 mb-1 text-sm">${room}</h4>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-gray-600">${generateRandomData(80, 100)}%</span>
                        <span class="text-xs bg-green-100 text-green-800">Normal</span>
                    </div>
                </div>
            `).join('');
        }

        function showMonthlyB3(month) {
            updateMonthTabs('b3', month);
            const grid = document.getElementById('b3Grid');
            grid.innerHTML = rooms.map(room => `
                <div class="room-card bg-white border rounded-lg p-3 cursor-pointer hover:shadow-lg" onclick="showDetail('${room}', '${month}', 'B3')">
                    <h4 class="font-semibold text-gray-800 mb-1 text-sm">${room}</h4>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-gray-600">${generateRandomData(70, 100)}%</span>
                        <span class="text-xs bg-yellow-100 text-yellow-800">B3</span>
                    </div>
                </div>
            `).join('');
        }

        function showMonthlyFasilitas(month) {
            updateMonthTabs('fasilitas', month);
            const grid = document.getElementById('fasilitasGrid');
            grid.innerHTML = rooms.map(room => `
                <div class="room-card bg-white border rounded-lg p-3 cursor-pointer hover:shadow-lg" onclick="showDetail('${room}', '${month}', 'Fasilitas')">
                    <h4 class="font-semibold text-gray-800 mb-1 text-sm">${room}</h4>
                    <div class="flex items-center justify-between">
                        <span class="text-xs text-gray-600">Normal</span>
                        <span class="text-xs bg-green-100 text-green-800">Baik</span>
                    </div>
                </div>
            `).join('');
        }

        function updateMonthTabs(category, activeMonth) {
            const tabs = document.querySelectorAll(`#${category} .month-tab`);
            tabs.forEach(tab => {
                tab.classList.remove('bg-blue-600', 'text-white');
                tab.classList.add('bg-gray-200', 'text-gray-700');
            });
            
            const activeTab = Array.from(tabs).find(tab => tab.textContent.toLowerCase().includes(activeMonth));
            if (activeTab) {
                activeTab.classList.remove('bg-gray-200', 'text-gray-700');
                activeTab.classList.add('bg-blue-600', 'text-white');
            }
        }

        function getRiskColor(level) {
            switch(level) {
                case 'Tinggi': return 'bg-red-100 text-red-800';
                case 'Sedang': return 'bg-yellow-100 text-yellow-800';
                case 'Rendah': return 'bg-green-100 text-green-800';
                default: return 'bg-gray-100 text-gray-800';
            }
        }

        function getRandomRiskLevel() {
            const levels = ['Tinggi', 'Sedang', 'Rendah'];
            return levels[Math.floor(Math.random() * levels.length)];
        }

        // Update clock
        function updateClock() {
            const now = new Date();
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const seconds = now.getSeconds().toString().padStart(2, '0');
            
            document.getElementById('clock').textContent = `${hours}:${minutes}:${seconds}`;
        }

        // Initialize clock and update every second
        updateClock();
        setInterval(updateClock, 1000);

        // Initialize security features
        window.addEventListener('load', () => {
            // Check if session is valid
            const sessionValid = localStorage.getItem('sessionValid');
            if (!sessionValid) {
                document.getElementById('blurOverlay').style.display = 'flex';
            } else {
                sessionValid = true;
                initFingerprint();
            }
            
            // Initialize security features
            preventScreenshot();
            initTrendChart();
        });
    </script>
</body>
</html>
